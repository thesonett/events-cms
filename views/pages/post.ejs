<div class="bg-gray-100 min-h-screen">
  <div class="w-full relative">
    <img src="<%= images[0]?.image_url || 'https://res.cloudinary.com/diobt2ibi/image/upload/v1748862503/undraw_avatars_xsfb_on45bq.jpg' %>" alt="Event Banner" class="w-full h-64 md:h-96 object-cover" />
    <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center">
      <div class="text-center text-white px-4">
        <h1 class="text-3xl md:text-5xl font-bold font-heading mb-4"><%= post.title || 'Not found!' %></h1>
        <p class="text-lg md:text-xl max-w-3xl mx-auto"><%= post.description || 'Not found!' %></p>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
      <div class="p-6 md:p-8">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 font-heading mb-6">Event Details</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Image -->
          <div>
            <img src="<%= images[0]?.image_url || 'https://res.cloudinary.com/diobt2ibi/image/upload/v1748862503/undraw_avatars_xsfb_on45bq.jpg' %>" alt="Main" class="w-full h-64 md:h-80 object-cover rounded-lg" />
          </div>

          <!-- Info -->
          <div>
            <h3 class="text-xl md:text-2xl font-bold text-gray-800 font-heading mb-4"><%= post.title || 'Not found!' %></h3>
            <div class="space-y-3">
              <p class="text-gray-600 text-base"><i class="fas fa-map-marker-alt mr-2 text-red-600"></i><span class="font-semibold">Location:</span> <%= post.location || 'Not found!' %>, <%= post.venue || 'Not found!' %></p>
              <p class="text-gray-600 text-base">
                <i class="fas fa-calendar-alt mr-2"></i>
                <span class="font-semibold">Date:</span> 
                <%= post.date ? new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : 'Not found!' %>
              </p>
              <p class="text-gray-600 text-base"><i class="fas fa-clock mr-2"></i><span class="font-semibold">Duration:</span> <%= post.duration || 'Not found!' %> hrs</p>
              <p class="text-gray-600 text-base">
                <i class="fas fa-clock mr-2"></i>
                <span class="font-semibold">Starts At:</span> 
                <%= post.time ? new Date('1970-01-01T' + post.time).toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' }) : 'Not found!' %>
              </p>
              <p class="text-gray-600 text-base"><i class="fas fa-user mr-2"></i><span class="font-semibold">Organizer:</span> <%= post.organizer || 'Not found!' %></p>
              <p class="text-base font-bold">
                <i class="text-gray-600 fas fa-info-circle mr-2"></i>
                <span class="font-semibold">Status: </span>
                <span class="<%= post.status === 'upcoming' ? 'text-red-600' : post.status === 'ongoing' ? 'text-blue-600' : 'text-green-600' %>">
                  <%= post.status.charAt(0).toUpperCase() + post.status.slice(1) %>
                </span>
              </p>
            </div>

            <div class="mt-6">
              <h4 class="text-lg font-semibold text-gray-700 mb-2">About this Event</h4>
              <p class="text-gray-600 text-base"><%= post.description || 'Not found!' %></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Gallery -->
      <div class="p-6 md:p-8">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 font-heading mb-6">Event Gallery</h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <script>const galleryImages = [];</script>
          <% if (images && images.length) { %>
            <% images.forEach((image, i) => { %>
              <script>galleryImages.push("<%= image.image_url %>");</script>
              <img src="<%= image.image_url %>" alt="Gallery Image" class="w-full h-40 md:h-48 object-cover rounded-lg cursor-pointer" onclick="showFlashcard(<%= i %>)" />
            <% }) %>
          <% } else { %>
            <script>galleryImages.push("https://res.cloudinary.com/diobt2ibi/image/upload/v1748862503/undraw_avatars_xsfb_on45bq.jpg");</script>
            <img src="https://res.cloudinary.com/diobt2ibi/image/upload/v1748862503/undraw_avatars_xsfb_on45bq.jpg" alt="Fallback" class="w-full h-40 md:h-48 object-cover rounded-lg cursor-pointer" onclick="showFlashcard(0)" />
          <% } %>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="flashcardModal" class="flashcard-modal">
    <span class="close-modal" onclick="closeFlashcard()">Ã—</span>
    <span class="nav-arrow left" onclick="prevImage()">&#10094;</span>
    <img id="flashcardImage" class="flashcard-image" src="" alt="Flashcard Image" />
    <span class="nav-arrow right" onclick="nextImage()">&#10095;</span>
  </div>

  <!-- Styles and Script -->
  <style>
    .flashcard-modal { position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; pointer-events: none; transition: background-color 0.3s ease, opacity 0.3s ease; }
    .flashcard-modal.active { opacity: 1; pointer-events: auto; background-color: rgba(0, 0, 0, 0.8); }
    .flashcard-image { max-width: 70%; max-height: 70%; border-radius: 0.5rem; opacity: 0; transform: scale(0.8); transition: opacity 0.4s ease, transform 0.4s ease; user-select: none; }
    .flashcard-modal.active .flashcard-image.visible { opacity: 1; transform: scale(1); }
    .close-modal { position: absolute; top: 1rem; right: 1rem; color: white; font-size: 2rem; cursor: pointer; opacity: 0; transition: opacity 0.3s ease; user-select: none; z-index: 1011; }
    .flashcard-modal.active .close-modal { opacity: 1; }
    .nav-arrow { position: absolute; top: 50%; transform: translateY(-50%); color: white; font-size: 3rem; cursor: pointer; opacity: 0.7; user-select: none; transition: opacity 0.3s ease; z-index: 1010; padding: 0.2rem 0.5rem; background-color: rgba(0, 0, 0, 0.4); border-radius: 0.25rem; }
    .nav-arrow:hover { opacity: 1; background-color: rgba(0, 0, 0, 0.7); }
    .nav-arrow.left { left: 1rem; }
    .nav-arrow.right { right: 1rem; }
  </style>

  <script>
    let currentIndex = -1;

    function showFlashcard(index) {
      if (index < 0 || index >= galleryImages.length) return;
      currentIndex = index;
      const modal = document.getElementById('flashcardModal');
      const image = document.getElementById('flashcardImage');
      image.classList.remove('visible');
      image.src = '';
      modal.classList.add('active');
      setTimeout(() => { image.src = galleryImages[currentIndex]; }, 10);
      image.onload = () => requestAnimationFrame(() => image.classList.add('visible'));
      image.onerror = () => { image.src = galleryImages[0]; };
    }

    function closeFlashcard() {
      const modal = document.getElementById('flashcardModal');
      const image = document.getElementById('flashcardImage');
      image.classList.remove('visible');
      setTimeout(() => { modal.classList.remove('active'); image.src = ''; currentIndex = -1; }, 300);
    }

    document.getElementById('flashcardModal').addEventListener('click', function (e) {
      if (e.target === this) closeFlashcard();
    });

    document.addEventListener('keydown', function (e) {
      if (currentIndex === -1) return;
      if (e.key === 'ArrowLeft') prevImage();
      else if (e.key === 'ArrowRight') nextImage();
      else if (e.key === 'Escape') closeFlashcard();
    });

    function prevImage() {
      if (currentIndex === -1) return;
      currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
      updateFlashcardImage();
    }

    function nextImage() {
      if (currentIndex === -1) return;
      currentIndex = (currentIndex + 1) % galleryImages.length;
      updateFlashcardImage();
    }

    function updateFlashcardImage() {
      const image = document.getElementById('flashcardImage');
      image.classList.remove('visible');
      setTimeout(() => { image.src = galleryImages[currentIndex]; }, 200);
      image.onload = () => requestAnimationFrame(() => image.classList.add('visible'));
    }
  </script>
</div>
